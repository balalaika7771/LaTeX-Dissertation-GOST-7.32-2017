% Настройки страницы по ГОСТ Р 7.0.11-2011 и ГОСТ 7.32-2017
\geometry{
    left=30mm,
    right=15mm,
    top=20mm,
    bottom=20mm
}

% Межстрочный интервал 1.5 по ГОСТу
\onehalfspacing

% Отступ первой строки абзаца 1.25 см по ГОСТу
\setlength{\parindent}{1.25cm}

% Настройки шрифтов по ГОСТу для pdfLaTeX
\usepackage{times}

% Настройки заголовков по ГОСТу 7.32-2017
\titleformat{\chapter}[display]
{\normalfont\bfseries\centering}
{\chaptertitlename\ \thechapter}{20pt}{\Large}

\titleformat{\section}
{\normalfont\bfseries}
{\thesection}{1em}{}

\titleformat{\subsection}
{\normalfont\bfseries}
{\thesubsection}{1em}{}

% Настройки оглавления по ГОСТу 7.32-2017
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsubsecleader}{\cftdotfill{\cftdotsep}}

% Настройки отступов в оглавлении по ГОСТ 7.32-2017
\renewcommand{\cftchapindent}{0pt}  % Главы без отступа
\renewcommand{\cftsecindent}{2em}   % Разделы с отступом 2 знака
\renewcommand{\cftsubsecindent}{4em} % Подразделы с отступом 4 знака

% Настройки шрифтов в оглавлении
\renewcommand{\cftchapfont}{\bfseries}
\renewcommand{\cftsecfont}{\normalfont}
\renewcommand{\cftsubsecfont}{\normalfont}

% Настройки отступов между элементами
\setlength{\cftbeforechapskip}{0pt}
\setlength{\cftbeforesecskip}{0pt}
\setlength{\cftbeforesubsecskip}{0pt}

% Настройки библиографии
\addbibresource{bibliography/references.bib}

% Настройки стиля библиографии по ГОСТ 7.32-2017
\DeclareFieldFormat{labelnumberwidth}{#1.}
\setlength{\biblabelsep}{0.5em}
\renewcommand*{\bibfont}{\small}
\setlength{\bibhang}{1.25cm} % абзацный отступ по ГОСТу

% Настройки гиперссылок
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=blue,
    citecolor=black,
    bookmarksnumbered=true,
    bookmarksopen=true,
    pdfstartview=FitH
}

% Настройки листингов кода
\lstset{
    basicstyle=\small\ttfamily,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    captionpos=b,
    commentstyle=\color{gray},
    keywordstyle=\color{blue},
    stringstyle=\color{red}
}

% Настройки нумерации по ГОСТу 7.32-2017
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\thetable}{\arabic{table}}
\renewcommand{\theequation}{\arabic{equation}}

% Настройки подписей к рисункам и таблицам по ГОСТ 7.32-2017
\captionsetup[figure]{
    font=small,
    justification=centering,
    singlelinecheck=false,
    skip=0pt,  % межстрочный интервал 1.0 (обычный)
    belowskip=0pt,
    aboveskip=0pt,
    hypcap=false  % запрет переноса слов в подписях к рисункам
}

\captionsetup[table]{
    font=small,
    justification=raggedright,
    singlelinecheck=false,
    skip=0pt,
    belowskip=0pt,
    aboveskip=0pt,
    hypcap=false  % запрет переноса слов в подписях к таблицам
}

% Переопределяем формат подписей для соответствия ГОСТу
\renewcommand{\figurename}{Рисунок}
\renewcommand{\tablename}{Таблица}

% Настройка формата подписи к рисунку по ГОСТ 7.32-2017
\DeclareCaptionFormat{gostfigure}{#1#2 — #3}
\captionsetup[figure]{format=gostfigure}

% Настройка формата подписи к таблице по ГОСТ 7.32-2017
\DeclareCaptionFormat{gosttable}{#1#2 — #3}
\captionsetup[table]{format=gosttable}

% Настройка переноса таблиц с заголовком "Продолжение таблицы X"
\usepackage{longtable}
\usepackage{ltxtable}

% Команда для создания продолжения таблицы
\newcommand{\tablecontinuation}[1]{%
    \multicolumn{1}{c}{\textbf{Продолжение таблицы #1}}%
}

% Настройка переноса листингов кода
\usepackage{fancyvrb}
\usepackage{listings}

% Настройки для переноса листингов
\lstset{
    breaklines=true,
    breakatwhitespace=true,
    breakautoindent=true,
    postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    extendedchars=true,
    inputencoding=utf8,
    literate={а}{{\cyra}}1 {б}{{\cyrb}}1 {в}{{\cyrv}}1 {г}{{\cyrg}}1 {д}{{\cyrd}}1 {е}{{\cyre}}1 {ё}{{\cyryo}}1 {ж}{{\cyrzh}}1 {з}{{\cyrz}}1 {и}{{\cyri}}1 {й}{{\cyrishrt}}1 {к}{{\cyrk}}1 {л}{{\cyrl}}1 {м}{{\cyrm}}1 {н}{{\cyrn}}1 {о}{{\cyro}}1 {п}{{\cyrp}}1 {р}{{\cyrr}}1 {с}{{\cyrs}}1 {т}{{\cyrt}}1 {у}{{\cyru}}1 {ф}{{\cyrf}}1 {х}{{\cyrh}}1 {ц}{{\cyrc}}1 {ч}{{\cyrch}}1 {ш}{{\cyrsh}}1 {щ}{{\cyrshch}}1 {ъ}{{\cyrhrdsn}}1 {ы}{{\cyry}}1 {ь}{{\cyrsftsn}}1 {э}{{\cyrerev}}1 {ю}{{\cyryu}}1 {я}{{\cyrya}}1
}

% Настройка для автоматического переноса длинных листингов
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{Code}{Verbatim}{
    fontsize=\small,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    breaklines=true,
    breakanywhere=true
}

% Настройка для автоматического переноса листингов с продолжением
\lstdefinestyle{breakable}{
    breaklines=true,
    breakatwhitespace=true,
    breakautoindent=true,
    postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    extendedchars=true,
    inputencoding=utf8,
    literate={а}{{\cyra}}1 {б}{{\cyrb}}1 {в}{{\cyrv}}1 {г}{{\cyrg}}1 {д}{{\cyrd}}1 {е}{{\cyre}}1 {ё}{{\cyryo}}1 {ж}{{\cyrzh}}1 {з}{{\cyrz}}1 {и}{{\cyri}}1 {й}{{\cyrishrt}}1 {к}{{\cyrk}}1 {л}{{\cyrl}}1 {м}{{\cyrm}}1 {н}{{\cyrn}}1 {о}{{\cyro}}1 {п}{{\cyrp}}1 {р}{{\cyrr}}1 {с}{{\cyrs}}1 {т}{{\cyrt}}1 {у}{{\cyru}}1 {ф}{{\cyrf}}1 {х}{{\cyrh}}1 {ц}{{\cyrc}}1 {ч}{{\cyrch}}1 {ш}{{\cyrsh}}1 {щ}{{\cyrshch}}1 {ъ}{{\cyrhrdsn}}1 {ы}{{\cyry}}1 {ь}{{\cyrsftsn}}1 {э}{{\cyrerev}}1 {ю}{{\cyryu}}1 {я}{{\cyrya}}1
}

% Настройка для переноса длинных листингов
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{Code}{Verbatim}{
    fontsize=\small,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    breaklines=true,
    breakanywhere=true
}

% Команда для создания продолжения листинга
\newcommand{\listingcontinuation}[1]{%
    \textbf{Продолжение листинга #1}%
}

% Настройки примечаний согласно ГОСТ 7.32-2017
\newcommand{\note}[1]{%
    \par\noindent\textbf{Примечание} — #1%
}

\newcommand{\notes}[1]{%
    \par\noindent\textbf{Примечания:}%
    \begin{enumerate}
        #1
    \end{enumerate}%
}

% Настройка межстрочного интервала для многострочных подписей
\captionsetup[table]{format=gosttable,skip=6pt}  % межстрочный интервал 1.0

% Настройки списков рисунков и таблиц
\renewcommand{\listfigurename}{СПИСОК ИЛЛЮСТРАЦИЙ}
\renewcommand{\listtablename}{СПИСОК ТАБЛИЦ}

% Настройки приложений
\renewcommand{\appendixname}{Приложение}
\renewcommand{\appendixpagename}{Приложения}

% ===== АВТОМАТИЧЕСКИЕ ПРАВИЛА ГОСТ =====

% Автоматические переносы слов по ГОСТу
\usepackage[english,russian]{babel}
\babelprovide[import]{russian}
\babelprovide[import]{english}

% Автоматические отступы для списков по ГОСТу
\setlength{\leftmargini}{2.5em}  % отступ для enumerate
\setlength{\leftmarginii}{2em}   % отступ для вложенных списков
\setlength{\leftmarginiii}{1.5em}
\setlength{\leftmarginiv}{1em}

% Автоматическое форматирование списков
\renewcommand{\labelenumi}{\arabic{enumi})}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii})}
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii})}
\renewcommand{\labelenumiv}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.\arabic{enumiv})}

% Автоматические отступы для itemize
\renewcommand{\labelitemi}{---}
\renewcommand{\labelitemii}{--}
\renewcommand{\labelitemiii}{-}
\renewcommand{\labelitemiv}{.}

% Автоматическое форматирование формул по ГОСТу
\renewcommand{\theequation}{\arabic{equation}}
\setlength{\abovedisplayskip}{6pt}
\setlength{\belowdisplayskip}{6pt}
\setlength{\abovedisplayshortskip}{0pt}
\setlength{\belowdisplayshortskip}{0pt}

% Автоматические правила для ссылок
\renewcommand{\autoref}[1]{\textbf{\ref{#1}}}
\renewcommand{\nameref}[1]{\textbf{\ref{#1}}}

% Автоматические правила для абзацев
\setlength{\parskip}{0pt}  % без отступов между абзацами
\setlength{\parindent}{1.25cm}  % отступ первой строки по ГОСТу

% Автоматические правила для переноса страниц
\widowpenalty=10000
\clubpenalty=10000
\raggedbottom

% Автоматические правила для переноса слов в тексте
\hyphenpenalty=50
\exhyphenpenalty=50
\doublehyphendemerits=10000
\finalhyphendemerits=5000

% Автоматические правила для таблиц
\setlength{\tabcolsep}{6pt}
\setlength{\arrayrulewidth}{0.4pt}
\renewcommand{\arraystretch}{1.2}

% Автоматические правила для рисунков
\setlength{\floatsep}{12pt}
\setlength{\textfloatsep}{12pt}
\setlength{\intextsep}{12pt}

% Автоматические правила для примечаний
\newcommand{\autonote}[1]{%
    \par\noindent\textbf{Примечание} — #1%
}

% Автоматические правила для списков литературы
\renewcommand{\bibname}{СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ}

% Автоматические правила для оглавления
\renewcommand{\contentsname}{ОГЛАВЛЕНИЕ}

% Автоматические правила для реферата
\renewcommand{\abstractname}{РЕФЕРАТ}

% Автоматические правила для заключения
\providecommand{\conclusionname}{ЗАКЛЮЧЕНИЕ}

% Автоматические правила для введения
\providecommand{\introductionname}{ВВЕДЕНИЕ}

% ===== АВТОМАТИЧЕСКИЕ КОМАНДЫ ДЛЯ УПРОЩЕНИЯ НАПИСАНИЯ =====
% Эти команды применяют правила ГОСТ автоматически

% Автоматическое создание рисунка с правильным форматированием
\newcommand{\autofigure}[4]{%
    \begin{figure}[H]%
        \centering%
        \includegraphics[width=#2]{#1}%
        \caption{#3}%
        \label{#4}%
    \end{figure}%
}

% Автоматическое создание таблицы с правильным форматированием
\newcommand{\autotable}[3]{%
    \begin{table}[H]%
        \centering%
        \caption{#2}%
        \label{#3}%
        #1%
    \end{table}%
}

% Автоматическое создание формулы с правильным форматированием
\newcommand{\autoformula}[2]{%
    \begin{equation}%
        #1%
        \label{#2}%
    \end{equation}%
}

% Автоматическое создание списка с правильным форматированием
\newcommand{\autolist}[1]{%
    \begin{enumerate}%
        #1%
    \end{enumerate}%
}

% Автоматическое создание маркированного списка
\newcommand{\autobulletlist}[1]{%
    \begin{itemize}%
        #1%
    \end{itemize}%
}

% Автоматическое создание ссылки с правильным форматированием
\providecommand{\autoref}[1]{%
    \textbf{\ref{#1}}%
}

% Автоматическое создание ссылки на рисунок
\newcommand{\autofigref}[1]{%
    \textbf{рисунок \ref{#1}}%
}

% Автоматическое создание ссылки на таблицу
\newcommand{\autotableref}[1]{%
    \textbf{таблица \ref{#1}}%
}

% Автоматическое создание ссылки на формулу
\newcommand{\autoformularef}[1]{%
    \textbf{формула \ref{#1}}%
}

% Автоматическое создание примечания
\providecommand{\autonote}[1]{%
    \par\noindent\textbf{Примечание} — #1%
}

% Автоматическое создание нескольких примечаний
\newcommand{\autonotes}[1]{%
    \par\noindent\textbf{Примечания:}%
    \begin{enumerate}%
        #1%
    \end{enumerate}%
}

% Автоматическое создание абзаца с правильным отступом
\newcommand{\autopar}[1]{%
    \par\noindent#1%
}

% Автоматическое создание заголовка раздела
\newcommand{\autosection}[1]{%
    \section{#1}%
}

% Автоматическое создание заголовка подраздела
\newcommand{\autosubsection}[1]{%
    \subsection{#1}%
}

% Автоматическое создание заголовка главы
\newcommand{\autochapter}[1]{%
    \chapter{#1}%
}
